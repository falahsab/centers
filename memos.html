<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>التعاميم - الموظفين</title>
<style>
body{font-family:"Tajawal",sans-serif;background:#0f172a;color:#e2e8f0;padding:15px;}
.container{max-width:600px;margin:auto;}
h2{text-align:center;color:#06b6d4;}
.memo{background:#1e293b;padding:10px;margin:10px 0;border-radius:8px;}
.memo p{margin:5px 0;}
</style>
</head>
<body>
<div class="container">
  <h2>التعاميم</h2>
  <div id="memos"></div>
</div>

<script>
const SCRIPT_ID = "AKfycbwZvptN5ADftcmgTykOBTGV1s4zBASbU6R37w8TyeuJOMY4KtwgoRfjs3RELJEYndYj";
const API_URL = `https://script.google.com/macros/s/${SCRIPT_ID}/exec`;

const $ = s=>document.querySelector(s);

async function fetchMemos(){
  try {
    const res = await fetch(API_URL);
    const memos = await res.json();
    const container = $('#memos');
    container.innerHTML = '';
    memos.forEach(m=>{
      if(m.Status === 'Active'){
        container.innerHTML += `
          <div class="memo">
            <b>${m.Title}</b> (${m.Date})<br>
            <p>${m.Content}</p>
          </div>`;
      }
    });
  } catch(err){
    console.error(err);
    $('#memos').innerHTML = `<p>⚠️ حدث خطأ أثناء جلب التعاميم</p>`;
  }
}

// جلب التعاميم عند فتح الصفحة
fetchMemos();
</script>
</body>
</html>
